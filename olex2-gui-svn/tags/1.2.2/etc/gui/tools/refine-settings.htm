<table border="0" width="100%" cellpadding="1" cellspacing="1" bgcolor="$GetVar(HtmlTableFirstcolColour)">

<tr ALIGN='left' NAME='SNUM_REFINEMENT_PROGRAM' width='100%'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=Refinement-Program;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td width='35%'>
    <b>Refinement Program</b>
  </td>
  <td ALIGN='right' width='65%'>
<!-- #include program gui\snippets\snippet-program.htm;scope=snum;prg_type=refinement;1; -->
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->

<tr NAME='SNUM_REFINEMENT_METHOD' width='100%'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=Refinement-Method;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td ALIGN='left' width='35%'>
    <b>Refinement Method</b>
  </td>
  <td ALIGN='right' width='65%'>
<!-- #include method gui\snippets\snippet-method.htm;scope=snum;prg_type=refinement;1; -->
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->

<tr NAME='SET_REFLECTIONS' width='100%'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=Set-Reflection-File;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td ALIGN='left' width='35%'>
    <b>%Reflection File%</b>
  </td>
  <td ALIGN='right' width='65%'>
<!-- #include tool-footer gui\snippets\snippet-reflection-file.htm;1; -->
</td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->

<tr ALIGN='left' NAME='SNUM_REFINEMENT_MAX_CYCLES'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=Refinement-Max-Cycles;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td ALIGN='left' width='70%'>
    <b>Maximum Refinement Iterations</b>
  </td>
  <td ALIGN='right' width='30%'>
      <input
        type='spin'
        width="50"
        height="GetVar('HtmlSPinHeight')"
        bgcolor="spy.GetParam('gui.html.input_bg_colour')"
        name='SET_SNUM_REFINEMENT_MAX_CYCLES'
        value="spy.GetParam('snum.refinement.max_cycles')"
        onchange="spy.SetMaxCycles(html.GetValue('~name~'))"
      >
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->

<tr ALIGN='left' NAME='SNUM_REFINEMENT_MAX_PEAKS'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=Refinement-Max-Peaks;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td ALIGN='left' width='70%'>
    <b>Number of Residual Peaks</b>
  </td>
  <td ALIGN='right' width='30%'>
      <input
        type="spin"
        bgcolor="spy.GetParam('gui.html.input_bg_colour')"
        name="SET_SNUM_REFINEMENT_MAX_PEAKS"
        width="50"
        height="GetVar('HtmlSPinHeight')"
        max='1000'
        value="math.eval(abs(spy.GetParam(snum.refinement.max_peaks)))"
        onchange="spy.SetMaxPeaks(html.GetValue('~name~'))"
      >
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->

<tr ALIGN='left' NAME='SNUM_WEIGHTING_SCHEME'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=Weighting-Scheme;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
$spy.weightGuiDisplay()
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->

<tr>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=Extinction-Correction;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td align="center" width="3%">
    <input type="checkbox" 
      width="GetVar('HtmlCheckboxWidth')"
      height="GetVar('HtmlCheckboxHeight')"
      fgcolor="GetVar('HtmlFontColour')"
      bgcolor="GetVar('HtmlTableFirstcolColour')"
      name="SNUM_REFINEMENT_EXTI"
      value=""
      oncheck="AddIns EXTI"
      onuncheck="DelIns EXTI"
      checked="not(strcmp(xf.rm.Exti(),'n/a'))"
    >
  </td>
  <td width="47%">Use extinction correction</td>
  <td>
    $xf.rm.Exti()
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->
</tr>

<tr VALIGN="center" ALIGN="left" NAME="USE_SOLVENT_MASK">
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=refinement-masks;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td ALIGN='center' width='3%'>
      <input
        type="checkbox"
        width="GetVar('HtmlCheckboxWidth')"
        height="GetVar('HtmlCheckboxHeight')"
        fgcolor="GetVar('HtmlFontColour')"
        bgcolor="GetVar('HtmlTableFirstcolColour')"
        name="SNUM_REFINEMENT_USE_SOLVENT_MASK"
        checked="spy.GetParam('snum.refinement.use_solvent_mask')"
        oncheck="spy.SetParam('snum.refinement.use_solvent_mask','true')"
        onuncheck="spy.SetParam('snum.refinement.use_solvent_mask','false')"
        value=""
      >
  </td>
  <td ALIGN='left' width='47%'>
    <b>
      Use solvent mask
    </b>
  </td>
  <td ALIGN='center' width='3%'>
      <input
        type="checkbox"
        width="GetVar('HtmlCheckboxWidth')"
        height="GetVar('HtmlCheckboxHeight')"
        fgcolor="GetVar('HtmlFontColour')"
        bgcolor="GetVar('HtmlTableFirstcolColour')"
        name="SNUM_REFINEMENT_RECOMPUTE_MASK_BEFORE_REFINEMENT"
        checked="spy.GetParam('snum.refinement.recompute_mask_before_refinement')"
        oncheck="
spy.SetParam('snum.refinement.use_solvent_mask','true')>>
spy.SetParam('snum.refinement.recompute_mask_before_refinement','true')>>
html.Update"
        onuncheck="spy.SetParam('snum.refinement.recompute_mask_before_refinement','false')"
        value=""
      >
  </td>
  <td ALIGN='left' width='47%'>
    <b>
      Recompute mask
    </b>
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->
</table>

<table border="0" style="border-collapse: collapse" width="100%" cellpadding="1" cellspacing="1" bgcolor="$GetVar(HtmlTableFirstcolColour)">
<!-- #includeif fs.Exists('refinement-settings-extra.htm') refinement-settings-extra refinement-settings-extra.htm;gui\blocks\tool-h3-off.htm;image=h3-refinement settings extra;colspan=4;onclick=;onclick=;2; -->
<!-- #includeif fs.Exists('refinement_image.htm') refinement_image refinement_image.htm;1; -->
</table>