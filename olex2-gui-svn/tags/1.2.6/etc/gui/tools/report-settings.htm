<table cellpadding="1" cellspacing="1" width='100%'>
  <tr>
    <td bgcolor="#cccccc">


<table border="0" VALIGN='center' width="100%" cellpadding="1" cellspacing="1" bgcolor="$GetVar(HtmlTableBgColour)">
<tr VALIGN='center' ALIGN='center' NAME='SNUM_REPORT_TITLE' valign='center'>
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td width='35%' align='left'>
    <font size="$GetVar('HtmlFontSizeMedium')" color="#555555">
    <input
      type='text'
      valign='center'
      height="math.eval(GetVar('HtmlInputHeight')*1.3)"
      width="100%"
      bgcolor="spy.GetParam('gui.html.input_bg_colour')"
      name='SET_SNUM_REPORT_TITLE'
      value="spy.report.get_report_title()"
      onchange="spy.SetParam('snum.report.title',html.GetValue('~name~'))"
    >
    </font>
  </td>

  <td width='10%' align='right'>
    %Image%
  </td>
  <td width='20%' align='left'>
    <font size="$GetVar('HtmlFontSizeControls')">
    <input
      type="combo"
      width="100%"
      height="GetVar('HtmlComboHeight')"
      bgcolor="spy.GetParam('gui.html.input_bg_colour')"
      name="SET_REPORT_IMAGE"
      readonly
      items='strcat("No Image;SCREENSHOT;",file.ListDirForGui(FilePath(),"*.png;*.jpg;*.bmp;*.ps;*.eps"))'
      onchange="spy.SetParam('snum.report.image',html.GetValue('~name~'))"
      width="50%"
      value="file.GetName(spy.GetParam('snum.report.image'))"
    >
    </font>
  </td>
  <td width='34%' align='right'>
$spy.MakeHoverButton('three-Make_Report','html.ItemState cbtn-solve 1 cbtn-refine solve-settings 0 refine-settings 0>>html.Update>>cursor(busy, 'Checking for CIF file ...')>>report>>cursor()>>html.Update')
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->

<tr VALIGN='center' ALIGN='center' NAME='SNUM_REPORT_TITLE' valign='center'>
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td width='8%' align='left'>
    &nbsp;%Style%
  </td>
  <td width='22%' align='left'>
    <font size="$GetVar('HtmlFontSizeControls')">
    <input
      type='combo'
      width="100%"
      height="GetVar('HtmlComboHeight')"
      bgcolor="spy.GetParam('gui.html.input_bg_colour')"
      name='SET_USER_REPORT_STYLE'
      value="spy.GetParam('user.report.style')"
      items='spy.getStylesList()'
      valign='center'
      onchange="spy.SetReportStyle(html.GetValue('~name~'))"
    >
    </font>
  </td>

  <td width='15%' align='right'>
    %Begin with%
  </td>
  <td width='23%'>
    <font size="$GetVar('HtmlFontSizeControls')">
    <input
      type='combo'
      width="100%"
      height="GetVar('HtmlComboHeight')"
      bgcolor="GetVar('HtmlInputBgColour')"
      name='SET_USER_REPORT_TEMPLATE'
      value="spy.GetParam('user.report.template')"
      items='spy.getTemplatesList()'
      valign='center'
      onchange="spy.SetReportTemplate(html.GetValue('~name~'),template)"
    >
    </font>
  </td>

  <td width='13%' align='right'>
    %End with%
  </td>
  <td width='24%'>
    <font size="$GetVar('HtmlFontSizeControls')">
    <input
      type='combo'
      width="100%"
      height="GetVar('HtmlComboHeight')"
      bgcolor="GetVar('HtmlInputBgColour')"
      name='SET_USER_REPORT_FOOTER'
      value="spy.GetParam('user.report.footer')"
      items='spy.getTemplatesList()'
      valign='center'
      onchange="spy.SetReportTemplate(html.GetValue('~name~'),footer)"
    >
    </font>
  </td>

<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->
<tr VALIGN='center' ALIGN='center' NAME='SNUM_REPORT_TITLE' valign='center'>
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->


<td width="20%" align='left'>&nbsp;Table label style:</td>
<td width="30%">$+
   html.Snippet("gui/snippets/input-combo", "name=report_label_style",
    "items=As in CIF<-0;In brackets<-1;Subscript<-2;Superscript<-4;In brackets subscript<-3;In brackets superscript<-5",
    "value=spy.GetParam('user.report_label_style')",
    "onchange=spy.SetParam('user.report_label_style', html.GetValue('~name~'))")
$-</td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->
</table>
</table>
<!-- #include report-metadata gui\tools\report-metadata.htm;1; -->

<table cellpadding="1" cellspacing="1" width='100%'>
  <tr>
    <td bgcolor="#cccccc">

<table border="0" VALIGN='center' width="100%" cellpadding="1" cellspacing="1" bgcolor="$GetVar(HtmlTableBgColour)">

<tr align = 'center' name=EDIT_CIF width='100%'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=CIF-Part-1;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td name=EDIT_CIF_INFO align='left' VALIGN='left' width='34%'>
$spy.MakeHoverButton('three-EditCifInfo','spy.ExtractCifInfo(True,True)>>spy.EditCifInfo()>>html.Update')
  </td>
  <td name=MERGE_CIF_INFO align='left' VALIGN='right' width='32%'>
$spy.MakeHoverButton('three-Merge_Cif','spy.ExtractCifInfo(True,True)>>spy.MergeCif(True)>>html.Update')
  </td>
  <td width='34%' align='right'>
  <input type="combo"
    name="SET_CIF_FINALISE"
    label=""
    width="94%"
    items="Include HKL/RES<-Include;Exclude HKL/RES<-Exclude;Ignore HKL/RES<-Ignore"
    value="spy.GetParam('user.cif.finalise')"
    height="GetVar('HtmlComboHeight')"
    bgcolor="GetVar('HtmlTableBgColour')"
    onchange="spy.SetParam('user.cif.finalise',html.GetValue('~name~'))"
    readonly
  >
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->

<tr align = 'center' name=EDIT_CIF width='100%'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=CIF-Part-2;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->

  <td name=GET_CHECKCIF_REPORT align='left' VALIGN='center' width='34%'>
$spy.MakeHoverButton('three-Checkcif_Report','spy.cif.GetCheckCifReport(html.GetState(SET_CHECKCIF_FCF))')
  </td>

  <td name=GET_CHECKCIF_REPORT_FORMAT align='left' VALIGN='center' width='12%'>
   <input
      type='combo'
      width="100%"
      height="GetVar('HtmlComboHeight')"
      bgcolor="GetVar('HtmlTableBgColour')"
      name='SET_CHECKCIF_FORMAT'
      value="spy.GetParam('user.cif.checkcif.format')"
      items='html;pdf'
      valign='center'
      onchange="spy.SetParam('user.cif.checkcif.format',html.GetValue('~name~'))"
      readonly
    >
  </td>

  <td width='15%' align='right'>
  Send FCF
  </td>

  <td name=GET_CHECKCIF_REPORT_FORMAT align='right' VALIGN='center' width='5%'>
    <input
      type='checkbox'
      bgcolor="GetVar('HtmlTableBgColour')"
      name='SET_CHECKCIF_FCF'
      checked='false'
      right='false'
    >
  </td>

  <td name=REQUEST_CCDC_NUMBER align='right' width = '34%'>
$spy.MakeHoverButton('three-CCDC_Number','spy.ccdc_submit()')
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->


<tr align = 'center' name=EDIT_CIF width='100%'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=CIF-Part-3;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->

<td name=AUTO_MERGE_CIF align='right' VALIGN='right' width='5%'>
    <input
      type='checkbox'
      bgcolor="GetVar('HtmlTableBgColour')"
      name = "CIFMERGE_AFTER_REFINE"
      checked = "spy.GetParam(snum.refinement.cifmerge_after_refinement)"
      onclick = "spy.SetParam(snum.refinement.cifmerge_after_refinement,html.GetState(~name~))"
      name='SET_CIFMERGE'
      right='false'
    >
</td>

  <td align='left' width='15%'>
Merge CIF:
  </td>

  <td align='left' width='68%'>
<a target='Edit the built-in CIF information' href='spy.EditCifInfo()'>metacif</a> $spy.gui.report.publication.DisplayMergeList()
  </td>

  <td align='right' width ='12%'>
<a href="spy.gui.report.publication.add_cif_to_merge_list(FileOpen('Choose definition file','.cif files|*.cif','$BaseDir()/etc/site'))>>html.Update">
  <b>add CIF</b>
  </td>
<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->

<!-- #ignoreif sg('%c')
<tr align = 'center' name=EDIT_CIF width='100%'>
<!-- #include tool-help-first-column gui\blocks\tool-help-first-column.htm;help_ext=ABS-STR;1; -->
<!-- #include row_table_on gui\blocks\row_table_on.htm;1; -->
  <td width="50%">Absolute structure determination
    <br>Flack parameter: $spy.GetParam('snum.refinement.flack_str')
    <br>Hooft parameter: $spy.GetParam('snum.refinement.hooft_str')
   </td>
   <td width="50%">$+
     html.Snippet("gui/snippets/input-combo", "name=abs_str_determination",
      "value=spy.get_cif_item('_chemical_absolute_configuration')",
      "items=Anomalous dispersion<-ad;Reference molecule<-rm;Reference molecule + AD<-rmad;
Synthesis<-syn;Unknown<-unk;Not applicable<-.;",
      "onchange=spy.set_cif_item('_chemical_absolute_configuration', html.GetValue('~name~'))")
    $-</td>

<!-- #include row_table_off gui\blocks\row_table_off.htm;1; -->
#ignoreif -->


</table>
      </td>
    </tr>
  </table>
