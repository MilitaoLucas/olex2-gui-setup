<!-- #include header gui\blocks\tool-table-header.htm;1; -->

<tr VALIGN='center' ALIGN='left' NAME='SET_SNUM_REFINEMENT_FORMULA'>
  <td width="2" bgcolor="$spy.GetParam(gui.html.table_firstcol_colour)"></td>
  <td width='50%' VALIGN='center' colspan=2>
    <b>%Chemical Composition%</b>
  </td>
  <td width='50%' VALIGN='center' ALIGN='right' colspan=2>
    <font size='2'>
      <input
        type='combo'
        width='$eval(spy.GetParam(gui.htmlpanelwidth)/2 - spy.GetParam(gui.htmlpanelwidth_margin_adjust))' 
        height="$spy.GetParam(gui.html.combo_height)"
        bgcolor="spy.GetParam(gui.html.input_bg_colour)"
        name='SET_SNUM_REFINEMENT_FORMULA'
        items='$spy.GetParam(snum.refinement.original_formula)'
        value='xf.GetFormula()'
        onchange='xf.SetFormula(GetValue(SET_SNUM_REFINEMENT_FORMULA))>>spy.SetParam(snum.refinement.formula,"GetValue(SET_SNUM_REFINEMENT_FORMULA)")>>updatehtml'
      >
    </font>
  </td>
</tr>

<tr VALIGN='center' ALIGN='left' NAME='Z'>
  <td width="2" bgcolor="$spy.GetParam(gui.html.table_firstcol_colour)"></td>
  <td width='50%' VALIGN='center' colspan=3>
    <b>%Number of Formula Units%</b>
  </td>
  <td width='50%' VALIGN='center' ALIGN='right' colspan=1>
    <font size='2'>
      <input
        type='spin'
        width=50
        height="$spy.GetParam(gui.html.spin_height)"
        bgcolor="spy.GetParam(gui.html.input_bg_colour)"
        name='SET_Z'
        min='1'
        value='xf.au.GetZ()'
        onchange="xf.au.SetZ(GetValue(SET_Z))>>updatehtml"
      >
    </font>
  </td>
</tr>

<tr VALIGN='center' ALIGN='left' NAME='Z Prime'>
  <td width="2" bgcolor="$spy.GetParam(gui.html.table_firstcol_colour)"></td>
  <td width='50%' VALIGN='center' colspan=3>
    <b>%Number in Asymmetric Unit%</b>
  </td>
  <td width='50%' VALIGN='center' ALIGN='right' colspan=1>
    <font size='2'>
      <input
        type='text'
        width="40"
        height="$spy.GetParam(gui.html.spin_height)"
        bgcolor="spy.GetParam(gui.html.input_bg_colour)"
        name='SET_Z_PRIME'
        value='xf.au.GetZprime()'
        onleave="xf.au.SetZprime(GetValue(SET_Z_PRIME))>>updatehtml"
      >
    </font>
  </td>
</tr>

<tr VALIGN='center' ALIGN='left' NAME='Z Prime'>
  <td width="2" bgcolor="$spy.GetParam(gui.html.table_firstcol_colour)"></td>
  <td width='50%' VALIGN='center' colspan=3>
    <b>%Adjust Current Formula to what is on the screen%</b>
  </td>
  <td width='50%' VALIGN='center' ALIGN='right' colspan=1>
    <a 
      href="fixunit xf.au.GetZprime()>>updatehtml"
      target="%Fix Unit-target% ">
      <zimg border="0" src="toolbar-OK.png"/>
    </a>
  </td>
</tr>


<tr VALIGN='center' ALIGN='left' NAME='Atomic Volume'>
  <td width="2" bgcolor="$spy.GetParam(gui.html.table_firstcol_colour)"></td>
  <td VALIGN='center' colspan=3>
    <b>%Current Atomic Volume%</b>
  </td>
  <td VALIGN='center' ALIGN='right' colspan=1>
    <b>
      $GetVar(current_atomic_volume)
    </b>
    &Aring;
  </td>
</tr>

</table>

